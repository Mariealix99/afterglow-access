<!-- <mat-table app-cell-focuser #cellFocuser="cellFocuser" #table [dataSource]="dataSource" [trackBy]="trackByFn">

  <ng-container matColumnDef="select">
    <mat-header-cell *matHeaderCellDef class="select-header-cell" app-focusable-cell #cell="cell" [rowIndex]="0" [columnIndex]="0"
      (focus)="cb?.focus()" [cellInTabOrder]="false">
      <mat-checkbox #cb [disabled]="!showSelectAll()" (change)="$event ? masterToggle() : null" [checked]="multiSelectionModel.hasValue() && isAllSelected()"
        [indeterminate]="multiSelectionModel.hasValue() && !isAllSelected()" [tabIndex]="cell.isActiveCell ? 0 : -1">
      </mat-checkbox>
    </mat-header-cell>
    <mat-cell *matCellDef="let row; let rowIndex = index;" app-focusable-cell #cell="cell" [rowIndex]="allowMultiSelection ? rowIndex+1 : rowIndex"
      [columnIndex]="0" (focus)="cb?.focus()" [cellInTabOrder]="primarySelectionModel.isSelected(row)">
      <mat-checkbox #cb (click)="$event.stopPropagation()" (change)="$event ? multiSelectionModel.toggle(row) : null" [checked]="primarySelectionModel.isSelected(row) || multiSelectionModel.isSelected(row)"
        [tabIndex]="cell.isActiveCell ? 0 : -1"  [disabled]="primarySelectionModel.isSelected(row)">
      </mat-checkbox>
    </mat-cell>
  </ng-container>

  <ng-container matColumnDef="name">
    <mat-header-cell *matHeaderCellDef class="select-header-cell" app-focusable-cell [rowIndex]="0" [columnIndex]="allowMultiSelection ? 1 : 0"
      [cellInTabOrder]="true">
      Name
    </mat-header-cell>
    <mat-cell *matCellDef="let row; let rowIndex = index;" app-focusable-cell #cell="cell" [rowIndex]="allowMultiSelection ? rowIndex+1 : rowIndex"
      [columnIndex]="allowMultiSelection ? 1 : 0" [cellInTabOrder]="true" (click)="onRowClick(row)" (keydown.space)="$event.preventDefault();"
      (keyup)="onRowKeyup($event, row);">
      <div class="item-row" [class.selected]="primarySelectionModel.isSelected(row)">
        <div class="valign-center">
          <span class="filename">{{row.name}}</span>
        </div>
      </div>
    </mat-cell>
  </ng-container>


  <mat-header-row [hidden]="!allowMultiSelection" *matHeaderRowDef="['select', 'name']"></mat-header-row>
  
  <mat-row *matRowDef="let row; columns: allowMultiSelection ? ['select', 'name'] : ['name'];"></mat-row>
</mat-table> -->

<!-- <tree-root [nodes]="nodes$ | async" [options]="options"></tree-root> -->

<mat-table
  app-cell-focuser
  #cellFocuser="cellFocuser"
  #table
  [dataSource]="items"
  [trackBy]="trackByFn"
  class="data-file-list"
>
  <!-- Name Column -->
  <ng-container matColumnDef="name">
    <mat-header-cell
      *matHeaderCellDef
      class="select-header-cell"
      app-focusable-cell
      [rowIndex]="0"
      [columnIndex]="0"
      [cellInTabOrder]="true"
    >
      Name
    </mat-header-cell>
    <mat-cell
      *matCellDef="let row; let rowIndex = index"
      app-focusable-cell
      #cell="cell"
      [rowIndex]="rowIndex"
      [columnIndex]="0"
      [cellInTabOrder]="true"
      (click)="onRowClick(row)"
      (dblclick)="onRowDoubleClick(row)"
      (keydown.space)="$event.preventDefault()"
      (mouseenter)="mouseOverFileId = row.id"
      (mouseleave)="mouseOverFileId = null"
    >
      <div
        fxLayout="row"
        fxLayoutAlign="start center"
        fxFlexFill
        class="item-row data-file-list-item"
        [class.selected]="selectedItem?.type == row.type && selectedItem?.id == row.id"
        [ngClass]="{
          'hdu' : row.type == 'hdu',
          'image-hdu': row.type == 'hdu' && row.hduType == HduType.IMAGE,
          'table-hdu': row.type == 'hdu' && row.hduType == HduType.TABLE
        }"
      >
        <div fxFlex="1 1 auto">
          <span class="filename" style="user-select: none">
            <ng-container *ngIf="row.type == 'file'">{{row.name}}</ng-container>
            <ng-container *ngIf="row.type == 'hdu'">
              <mat-icon *ngIf="row.hduType == HduType.IMAGE" aria-hidden="false" aria-label="image icon">insert_photo</mat-icon>
              <mat-icon *ngIf="row.hduType == HduType.TABLE" aria-hidden="false" aria-label="table icon">toc</mat-icon>
              {{getHduName(row)}}
            </ng-container>
          </span>
        </div>
        <div fxFlex="0 0 60px" style="text-align: right;" *ngIf="row.type == 'file'">
          <!-- <button
            [hidden]="mouseOverFileId != row.id || !row.modified"
            mat-icon-button
            class="small mr-2"
            aria-label="Save File"
            (click)="saveFile(row.id)"
            matTooltip="Save File"
            matTooltipShowDelay="500"
          >
            <mat-icon>save</mat-icon>
          </button>
          <button
            [hidden]="mouseOverFileId != row.id && !row.modified"
            mat-icon-button
            class="small"
            aria-label="Close File"
            (click)="closeFile(row.id)"
            matTooltip="Close File"
            matTooltipShowDelay="500"
          >
            <mat-icon>{{
              mouseOverFileId === row.id || !row.modified
                ? "clear"
                : "fiber_manual_record"
            }}</mat-icon>
          </button> -->
        </div>
      </div>
    </mat-cell>
  </ng-container>

  <mat-row *matRowDef="let row; columns: ['name']"></mat-row>
</mat-table>


